<div class="container">
  <h2>Hotspot Plans</h2>

  <!-- Loading -->
  <p *ngIf="loading" class="loading">Loading plans...</p>

  <!-- Plans list as flex boxes -->
  <div *ngIf="!isCreating && !loading" class="plans-grid">
    <div *ngFor="let plan of plans" class="plan-card">
      <h3>{{ plan.name }}</h3>
      <p><strong>{{ plan.price }}</strong> KES</p>
      <p>{{ plan.trialDays || 0 }} trial days</p>
      <p *ngIf="plan.autoOn" class="badge online">âš¡ Auto On/Off Enabled</p>
      <p *ngIf="plan.purchasersCount">ðŸ‘¥ {{ plan.purchasersCount }} users</p>

      <button class="btn small" (click)="recharge(plan)">Recharge</button>
    </div>
  </div>

  <!-- No plans -->
  <div *ngIf="!isCreating && !loading && plans.length === 0" class="empty">
    No plans found.
  </div>

  <!-- Button BELOW packages -->
  <div *ngIf="!isCreating && !loading" class="create-btn-wrapper">
    <button (click)="isCreating = true" class="btn success">+ Create New Plan</button>
  </div>

  <!-- Create plan form -->
  <div *ngIf="isCreating" class="form-container">
    <h3>Create New Plan</h3>
    <form (ngSubmit)="createPlan()" #planForm="ngForm">
      <input [(ngModel)]="newPlan.name" name="name" placeholder="Plan Name" required />
      <input [(ngModel)]="newPlan.price" name="price" type="number" placeholder="Price (KES)" required />
      <input [(ngModel)]="newPlan.trialDays" name="trialDays" type="number" placeholder="Trial Days" />

      <label>
        <input type="checkbox" [(ngModel)]="newPlan.autoOn" name="autoOn" />
        Auto Online/Offline Connect
      </label>

      <div class="form-actions">
        <button type="button" class="btn secondary" (click)="isCreating = false">Cancel</button>
        <button type="submit" class="btn success" [disabled]="planForm.invalid">Save Plan</button>
      </div>
    </form>
  </div>
</div>
